name = "precept-worker"
main = "src/index.ts"
compatibility_date = "2024-01-29"

# Serve static assets from the web app build directory
[assets]
directory = "../web/dist"
binding = "ASSETS"

[vars]
SUPABASE_URL = "https://mwibyylfnfxojdxsbzga.supabase.co"
SUPABASE_ANON_KEY = "sb_publishable_ViDArTpEg-NOc2pzPy360g_nuOb1fZT"
# SUPABASE_SERVICE_ROLE_KEY will be set via secret
ENABLE_AUTH = "false" # Default to false for local dev

[env.staging]
name = "precept-worker-staging"
[env.staging.assets]
directory = "../web/dist"
binding = "ASSETS"
[[env.staging.kv_namespaces]]
binding = "BIBLE_CACHE"
id = "49558b44421f4a858078fd358f176310"
[env.staging.vars]
ENABLE_AUTH = "true"
SUPABASE_URL = "https://mwibyylfnfxojdxsbzga.supabase.co"
SUPABASE_ANON_KEY = "sb_publishable_ViDArTpEg-NOc2pzPy360g_nuOb1fZT"

[env.production]
name = "precept-worker-prod"
routes = [
  { pattern = "inductivebible.ai", custom_domain = true },
  { pattern = "www.inductivebible.ai", custom_domain = true }
]
[env.production.assets]
directory = "../web/dist"
binding = "ASSETS"
[[env.production.kv_namespaces]]
binding = "BIBLE_CACHE"
id = "a90045ce6c8f404a8c7db45b274f0532"
[env.production.vars]
ENABLE_AUTH = "true"
SUPABASE_URL = "https://mwibyylfnfxojdxsbzga.supabase.co"
SUPABASE_ANON_KEY = "sb_publishable_ViDArTpEg-NOc2pzPy360g_nuOb1fZT"

[[kv_namespaces]]
binding = "BIBLE_CACHE"
id = "todo_replace_with_real_id"
